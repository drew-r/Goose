<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Goose by drew-r</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/drew-r/Goose">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/drew-r/Goose/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/drew-r/Goose/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Goose</h1>
          <p>Runtime C# compilation and integrated Lua scripting for fun and profit.</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/drew-r">drew-r</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a name="here-lives" class="anchor" href="#here-lives"><span class="octicon octicon-link"></span></a>Here lives...</h1>

<p>...the documentation for Goose, a project that combines runtime C# compilation with Lua scripting (<a href="nlua.org">NLua</a>). </p>

<h2>
<a name="what-does-it-do" class="anchor" href="#what-does-it-do"><span class="octicon octicon-link"></span></a>What does it do?</h2>

<p>Goose allows you to make use of C# classes &amp; objects compiled at runtime, without invoking a single reflection method. This provides workable C# scripting, on the condition that you are happy to glue scripted C# components into the CLR with Lua.</p>

<p>This comes built on top of NLua's already excellent functionality (quite literally, the Goose VM inherits directly from NLua's), including automatic conversion between Lua and CLR primitives, Lua functions and CLR delegates (great for event handlers and callbacks) and Lua tables and CLR interfaces (dynamically implement a CLR interface with Lua) as well as support for invoking overloaded CLR methods etc.</p>

<h3>
<a name="by-example" class="anchor" href="#by-example"><span class="octicon octicon-link"></span></a>By example...</h3>

<h4>
<a name="compile-a-class" class="anchor" href="#compile-a-class"><span class="octicon octicon-link"></span></a>Compile a class</h4>

<p><em>from string(s), file paths, directory paths or a combination of the above.</em></p>

<div class="highlight highlight-csharp"><pre>
<span class="n">VM</span> <span class="n">vm</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Goose</span><span class="p">.</span><span class="n">VM</span><span class="p">();</span>

<span class="n">vm</span><span class="p">.</span><span class="n">Compile</span><span class="p">(</span><span class="s">"HelloWorldAssembly"</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">@"</span>
<span class="s">using System; </span>
<span class="s">using System.Windows.Forms;</span>
<span class="s">namespace HelloWorldNamespace </span>
<span class="s">{</span>
<span class="s">   public class HelloWorld </span>
<span class="s">   {</span>
<span class="s">      public void SayHello()</span>
<span class="s">      { </span>
<span class="s">         MessageBox.Show(""Hello, World""); </span>
<span class="s">      }</span>
<span class="s">   }</span>
<span class="s">}</span>
<span class="s">"</span><span class="p">},</span><span class="s">"System.Windows.Forms"</span><span class="p">);</span>

</pre></div>

<h4>
<a name="create-an-instance-and-invoke-a-method-from-lua" class="anchor" href="#create-an-instance-and-invoke-a-method-from-lua"><span class="octicon octicon-link"></span></a>Create an instance and invoke a method from Lua</h4>

<div class="highlight highlight-csharp"><pre>
<span class="n">vm</span><span class="p">.</span><span class="n">DoString</span><span class="p">(</span><span class="s">"h = HelloWorld()"</span><span class="p">);</span>
<span class="n">vm</span><span class="p">.</span><span class="n">DoString</span><span class="p">(</span><span class="s">"h:SayHello()"</span><span class="p">);</span>

</pre></div>

<h4>
<a name="or-return-the-instance-to-the-clr-and-invoke-it-from-there" class="anchor" href="#or-return-the-instance-to-the-clr-and-invoke-it-from-there"><span class="octicon octicon-link"></span></a>or return the instance to the CLR and invoke it from there</h4>

<div class="highlight highlight-csharp"><pre>
<span class="kt">dynamic</span> <span class="n">h</span> <span class="p">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">DoString</span><span class="p">(</span><span class="s">"return h"</span><span class="p">)[</span><span class="m">0</span><span class="p">];</span>
<span class="n">h</span><span class="p">.</span><span class="n">SayHello</span><span class="p">();</span>

</pre></div>

<h4>
<a name="easily-convert-a-lua-table-to-a-poco-eg-for-serialization-by-jsonnet-" class="anchor" href="#easily-convert-a-lua-table-to-a-poco-eg-for-serialization-by-jsonnet-"><span class="octicon octicon-link"></span></a>Easily convert a Lua table to a POCO (e.g for serialization by <a href="json.net">JSON.NET</a> :)</h4>

<div class="highlight highlight-csharp"><pre>
<span class="kt">dynamic</span> <span class="n">t</span> <span class="p">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">DoString</span><span class="p">(</span><span class="s">@"</span>
<span class="s">    return obj({ Forename=""Fred"", Surname=""Flintstone"" })</span>
<span class="s">"</span><span class="p">)[</span><span class="m">0</span><span class="p">];</span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s">"Forename"</span><span class="p">]);</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s">"Surname"</span><span class="p">]);</span>


</pre></div>

<h2>
<a name="reference" class="anchor" href="#reference"><span class="octicon octicon-link"></span></a>Reference</h2>

<h3>
<a name="vm--nlualua" class="anchor" href="#vm--nlualua"><span class="octicon octicon-link"></span></a>VM <em>: NLua.Lua</em>
</h3>

<h4>
<a name="import" class="anchor" href="#import"><span class="octicon octicon-link"></span></a>Import</h4>

<p>Imports an Assembly making it available at the Lua VM.</p>

<div class="highlight highlight-csharp"><pre><span class="k">void</span> <span class="nf">Import</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">Assembly</span> <span class="n">assembly</span><span class="p">)</span>
</pre></div>

<p><code>assembly</code>
The System.Reflection.Assembly to be imported.</p>

<h4>
<a name="compile" class="anchor" href="#compile"><span class="octicon octicon-link"></span></a>Compile</h4>

<p>Compiles an assembly from source. </p>

<div class="highlight highlight-csharp"><pre><span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">Assembly</span> <span class="n">Compile</span><span class="p">(</span><span class="kt">string</span> <span class="n">assemblyName</span><span class="p">,</span> 
                    <span class="kt">string</span><span class="p">[]</span> <span class="n">src</span><span class="p">,</span>
                    <span class="k">params</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">references</span><span class="p">)</span>
</pre></div>

<p><code>assemblyName</code>
The name of the assembly to be built. If generating in memory is disabled, this serves as the output path for the assembly and so full file paths are acceptable. </p>

<p><code>src</code>
The code base. Raw C#, the path to a C# source file, or the path to a directory containing C# source files are all acceptable inputs per element.</p>

<p><code>references</code>
An array of identifiers referencing dependency assemblies. The identifiers will be resolved against the file system and GAC.</p>

<h3>
<a name="util" class="anchor" href="#util"><span class="octicon octicon-link"></span></a>Util</h3>

<h4>
<a name="objarrayfromtable" class="anchor" href="#objarrayfromtable"><span class="octicon octicon-link"></span></a>ObjArrayFromTable</h4>

<p><em>Lua Global arr(t)</em></p>

<div class="highlight highlight-csharp"><pre><span class="k">static</span> <span class="kt">object</span><span class="p">[]</span> <span class="nf">ObjArrayFromTable</span><span class="p">(</span><span class="n">LuaTable</span> <span class="n">t</span><span class="p">)</span>
</pre></div>

<p>Transforms a <code>LuaTable</code> into an array of objects (child Lua Tables are converted via <code>ObjFromTable</code>). </p>

<h4>
<a name="stringarrayfromtable" class="anchor" href="#stringarrayfromtable"><span class="octicon octicon-link"></span></a>StringArrayFromTable</h4>

<p><em>Lua Global str_arr(t)</em></p>

<div class="highlight highlight-csharp"><pre><span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">StringArrayFromTable</span><span class="p">(</span><span class="n">LuaTable</span> <span class="n">t</span><span class="p">)</span>
</pre></div>

<p>Transforms a <code>LuaTable</code> into an array of strings (as IEnumerable).</p>

<h4>
<a name="objfromtableluatable-t" class="anchor" href="#objfromtableluatable-t"><span class="octicon octicon-link"></span></a>ObjFromTable(LuaTable t)</h4>

<p><em>Lua Global obj(t)</em></p>

<div class="highlight highlight-csharp"><pre><span class="k">static</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">StringArrayFromTable</span><span class="p">(</span><span class="n">LuaTable</span> <span class="n">t</span><span class="p">)</span>
</pre></div>

<p>Transforms a <code>LuaTable</code> into a CLR object (<code>Dictionary&lt;string, object&gt;</code>) that is easily indexable. 
Useful when passing <code>LuaTable</code>s back to the CLR. Will return an array via <code>ObjArrayFromTable</code> if it is found that the table argument is in fact a Lua array. Child tables will be converted to objects via this method recursively.</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<h3>
<a name="the-mit-license-mit" class="anchor" href="#the-mit-license-mit"><span class="octicon octicon-link"></span></a>The MIT License (MIT)</h3>

<h4>
<a name="copyright-c-2014-drew-r" class="anchor" href="#copyright-c-2014-drew-r"><span class="octicon octicon-link"></span></a>Copyright (c) 2014 Drew R</h4>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>